{"componentChunkName":"component---src-templates-post-template-tsx","path":"/tech/2023-07-28-XSS와-CSRF/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<h2 id=\"0-들어가며\" style=\"position:relative;\"><a href=\"#0-%EB%93%A4%EC%96%B4%EA%B0%80%EB%A9%B0\" aria-label=\"0 들어가며 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>0. 들어가며</h2>\n<p>JWT를 관리하는 방안을 고민중 XSS와 CSRF에대한 언급이 많이 나왔다. 이 두가지에 대해 알아보고 어떻게 방어해야하는지 알아보자.</p>\n<h2 id=\"1-xss\" style=\"position:relative;\"><a href=\"#1-xss\" aria-label=\"1 xss permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. XSS</h2>\n<h3 id=\"1-xss는-무엇인가\" style=\"position:relative;\"><a href=\"#1-xss%EB%8A%94-%EB%AC%B4%EC%97%87%EC%9D%B8%EA%B0%80\" aria-label=\"1 xss는 무엇인가 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>(1) XSS는 무엇인가?</h3>\n<p>내가 이해한 XSS의 핵심은 일반 웹사이트에서 악성 스크립트를 유저가 실행하여 정보를 탈취하는 것이다.\r\n해커는 어떤 커뮤니티에 게시글을 쓰는데 그 게시글에 악성 스크립트를 삽입한다. 유저는 해당 게시글을 상세조회하면서 악성 스크립트를 실행하게 된다.<code class=\"language-text\">(Stored XSS)</code></p>\n<p>또는 해커는 악성 스크립트를 삽입한 다음과 같은 URL을 유저가 클릭하도록 한다.<br>\n<code class=\"language-text\">http://normal.web.site/?q=&lt;script>alert(\"XSS\")&lt;/script>&amp;x=0&amp;y=0</code>, 이렇게하면 해당 일반 웹사이트에서 해당 스크립트가 실행된다.<code class=\"language-text\">(Reflected XSS)</code><br>\n이때 해커는 URL 클릭 유도가 목표이므로 이메일 또는 해커 자체 웹사이트를 통해서 공격이 가능하다.</p>\n<h3 id=\"2-xss를-어떻게-방어해야하는가\" style=\"position:relative;\"><a href=\"#2-xss%EB%A5%BC-%EC%96%B4%EB%96%BB%EA%B2%8C-%EB%B0%A9%EC%96%B4%ED%95%B4%EC%95%BC%ED%95%98%EB%8A%94%EA%B0%80\" aria-label=\"2 xss를 어떻게 방어해야하는가 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>(2) XSS를 어떻게 방어해야하는가?</h3>\n<p>XSS를 방어하려면</p>\n<ol>\n<li>악성 스크립트를 실행하지 못하도록 해야한다.</li>\n</ol>\n<ul>\n<li>innerHTML 사용 자제(하지만, HTML5에서는 더 이상 innerHTML 내부의 스크립트는 실행되지 않음)</li>\n<li>악성 스크립트의 <code class=\"language-text\">&lt;</code>, <code class=\"language-text\">></code>와 같은 특수문자를 서버에서 치환할 수 있다.</li>\n</ul>\n<ol start=\"2\">\n<li>실행되어도 정보를 못가져가도록 해야한다.</li>\n</ol>\n<ul>\n<li>로컬 스토리지와 세션 스토리지에는 민감한 정보를 저장하지 않는다.</li>\n<li>쿠키는 httpOnly 옵션을 사용하여 해커의 악성 스크립트가 접근하지 못하도록 한다.</li>\n</ul>\n<p>나는 이번 프로젝트에서 <code class=\"language-text\">cookie</code>를 사용하기 때문에 <code class=\"language-text\">httpOnly</code> 옵션을 사용하여 XSS를 방어하였다.</p>\n<h3 id=\"3-react에서는-xss를-기본적으로-방어하고-있다\" style=\"position:relative;\"><a href=\"#3-react%EC%97%90%EC%84%9C%EB%8A%94-xss%EB%A5%BC-%EA%B8%B0%EB%B3%B8%EC%A0%81%EC%9C%BC%EB%A1%9C-%EB%B0%A9%EC%96%B4%ED%95%98%EA%B3%A0-%EC%9E%88%EB%8B%A4\" aria-label=\"3 react에서는 xss를 기본적으로 방어하고 있다 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>(3) React에서는 XSS를 기본적으로 방어하고 있다.</h3>\n<p>React에서는 JSX에 삽입된 값을 렌더링하기 전에 <code class=\"language-text\">escape</code>를 하기 때문에 XSS를 방어할 수 있다.</p>\n<blockquote>\n<p>특정 문자를 원래의 기능에서 벗어나게 변환하는 행위를 이스케이프(Escape)라고 한다.<br>\n<code class=\"language-text\">&amp;</code>은 <code class=\"language-text\">&amp;amp;</code>로<br>\n<code class=\"language-text\">&lt;</code>은 <code class=\"language-text\">&amp;lt;</code>로<br>\n<code class=\"language-text\">></code>은 <code class=\"language-text\">&amp;gt;</code>로<br>\n<code class=\"language-text\">\"</code>은 <code class=\"language-text\">&amp;quot;</code>로<br>\n띄어쓰기는 <code class=\"language-text\">&amp;nbsp;</code>로</p>\n</blockquote>\n<p>즉 해커의 악성 스크립트들은 원래 기능을 하지 못하고 문자열인 채로 렌더링된다.<br>\n<a href=\"https://www.stackhawk.com/blog/react-xss-guide-examples-and-prevention/\" target=\"_blank\" rel=\"nofollow\">React XSS Guide</a></p>\n<h2 id=\"2-csrf\" style=\"position:relative;\"><a href=\"#2-csrf\" aria-label=\"2 csrf permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. CSRF</h2>\n<h3 id=\"1-csrf는-무엇인가\" style=\"position:relative;\"><a href=\"#1-csrf%EB%8A%94-%EB%AC%B4%EC%97%87%EC%9D%B8%EA%B0%80\" aria-label=\"1 csrf는 무엇인가 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>(1) CSRF는 무엇인가?</h3>\n<p>내가 이해한 CSRF의 핵심은 일반 웹 사이트에서 일반 웹 서버로 원하지 않는(해커가 의도하는) 요청을 보내는 것이다.<br>\n유저는 은행 웹사이트에 로그인한 상태이고 브라우저에는 로그인 정보가 저장되어있다. 이때, 해커는 피해자의 100만원을 해커에게 송금하는 요청을 로그인 정보와 함께 은행 서버로 보내도록 유도한다.</p>\n<p>CSRF 공격은 어디에서나 일어날 수 있다.<br>\n해커 자체 웹사이트일 수도 있고, 일반 웹사이트에 삽입된 악성 스크립트일 수도 있다.<br>\n요점은 해커가 의도한 요청을 마치 유저가 의도한 것처럼 서버를 속이는 것이다.</p>\n<h3 id=\"2-csrf를-어떻게-방어해야하는가\" style=\"position:relative;\"><a href=\"#2-csrf%EB%A5%BC-%EC%96%B4%EB%96%BB%EA%B2%8C-%EB%B0%A9%EC%96%B4%ED%95%B4%EC%95%BC%ED%95%98%EB%8A%94%EA%B0%80\" aria-label=\"2 csrf를 어떻게 방어해야하는가 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>(2) CSRF를 어떻게 방어해야하는가?</h3>\n<p>쿠키 관리시 <code class=\"language-text\">same site</code> 옵션을 사용하여 내 도메인에서만 사용할 수 있도록 하였다. 이러면 해커의 웹 사이트에서 내 웹 사이트로 쿠키를 전송할 수 없으므로 CSRF 공격을 방어할 수 있다.<br>\n다만 우리 사이트 자체에 악성 스크립트가 삽입되어 CSRF 공격을 하는 경우는 방어할 수 없다.  하지만 이는 리액트 자체에서 방어하고 있다고 판단하였다.</p>\n<h2 id=\"3-마치며\" style=\"position:relative;\"><a href=\"#3-%EB%A7%88%EC%B9%98%EB%A9%B0\" aria-label=\"3 마치며 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. 마치며</h2>\n<p><code class=\"language-text\">cookie</code>를 사용하되 XSS는 <code class=\"language-text\">httpOnly</code> 옵션을 사용하여 방어하고 CSRF는 <code class=\"language-text\">same site</code> 옵션을 사용한다.<br>\n이러면 정보를 탈취하는 XSS 공격은 막을 수 있고, 해커의 웹사이트로부터 CSRF 공격을 방어할 수 있다.<br>\n내 웹사이트에 악성 스크립트를 삽입하여 CSRF 공격을 하는 것은 리액트에서 기본적으로 방어하고 있다고 판단하였다.<br>\n그럼에도 보안에 가장 신경써야 할 <code class=\"language-text\">Access Token</code>은 전역 상태로 관리하도록 하였다. 보안은 보수적으로 접근하는 것이 좋다고 생각하기 때문이다.</p>","tableOfContents":"<ul>\n<li>\n<p><a href=\"#0-%EB%93%A4%EC%96%B4%EA%B0%80%EB%A9%B0\">0. 들어가며</a></p>\n</li>\n<li>\n<p><a href=\"#1-xss\">1. XSS</a></p>\n<ul>\n<li><a href=\"#1-xss%EB%8A%94-%EB%AC%B4%EC%97%87%EC%9D%B8%EA%B0%80\">(1) XSS는 무엇인가?</a></li>\n<li><a href=\"#2-xss%EB%A5%BC-%EC%96%B4%EB%96%BB%EA%B2%8C-%EB%B0%A9%EC%96%B4%ED%95%B4%EC%95%BC%ED%95%98%EB%8A%94%EA%B0%80\">(2) XSS를 어떻게 방어해야하는가?</a></li>\n<li><a href=\"#3-react%EC%97%90%EC%84%9C%EB%8A%94-xss%EB%A5%BC-%EA%B8%B0%EB%B3%B8%EC%A0%81%EC%9C%BC%EB%A1%9C-%EB%B0%A9%EC%96%B4%ED%95%98%EA%B3%A0-%EC%9E%88%EB%8B%A4\">(3) React에서는 XSS를 기본적으로 방어하고 있다.</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#2-csrf\">2. CSRF</a></p>\n<ul>\n<li><a href=\"#1-csrf%EB%8A%94-%EB%AC%B4%EC%97%87%EC%9D%B8%EA%B0%80\">(1) CSRF는 무엇인가?</a></li>\n<li><a href=\"#2-csrf%EB%A5%BC-%EC%96%B4%EB%96%BB%EA%B2%8C-%EB%B0%A9%EC%96%B4%ED%95%B4%EC%95%BC%ED%95%98%EB%8A%94%EA%B0%80\">(2) CSRF를 어떻게 방어해야하는가?</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#3-%EB%A7%88%EC%B9%98%EB%A9%B0\">3. 마치며</a></p>\n</li>\n</ul>","frontmatter":{"title":"XSS와 CSRF","summary":"JWT를 관리 방법을 정하기 위해 XSS와 CSRF에 대해 알아보고 어떻게 방어해야하는지 정리","date":"2023년 07월 28일","tags":["보안"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABnElEQVR42mWS70/aQBjH+Zddsr0wi7plJgtvME6NJfiiLPTFkr0hAmFJ3y1GtxfgQCm0BFp6Be3Z0ja9K+Wuj6NFHfPz5rn7Pvnmnh+Xg5TFYtHvGZoy1dR7vastI5rpScrTGVjM4ekKALksh0y0u53f2y68ffN5f+v9nTnJ0lEUMcYAgAZLa+Crv2zPppBsmm3blqSv5fKZKJbKlTLGGAA45xhjxljCQf39oP9x9Y7b+2nTYLlhnk5nJ8dHh8XSwWmxJJxalrV6jdLZdAYAywWbKN7kxtW7jtF1iR+vzVkghLRbrUbjvNmsX7fbYRgCgCzLtVoNYNVqNT/4tnPz/dNt5V3XRTQbwdocxzEhBCETY3s+n2eiLMvVahUAHMcZ3hqDjjFSUK89MsYTztlL2RjjQqEgSZIoioIgmKYJAOPxmFIahmG9Xr+8uiiWhKPjLx8+7jV/NLNF5J6nahiGlqL0lCAIkiSxLItzDgC6riOEFKWvqtpwOPQ8b6Pn1zDGCCH/ib7vOykYY875izn5h1ffY00URYSQKOVv2Y/IaB7MYKKM2wAAAABJRU5ErkJggg=="},"images":{"fallback":{"src":"/static/72c21e5c8f960baf9fc91d025b9dc16b/c9340/image.png","srcSet":"/static/72c21e5c8f960baf9fc91d025b9dc16b/0b13a/image.png 300w,\n/static/72c21e5c8f960baf9fc91d025b9dc16b/ee0c7/image.png 600w,\n/static/72c21e5c8f960baf9fc91d025b9dc16b/c9340/image.png 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/72c21e5c8f960baf9fc91d025b9dc16b/da700/image.webp 300w,\n/static/72c21e5c8f960baf9fc91d025b9dc16b/cef4d/image.webp 600w,\n/static/72c21e5c8f960baf9fc91d025b9dc16b/e8d72/image.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1200,"height":628}},"publicURL":"/static/72c21e5c8f960baf9fc91d025b9dc16b/image.png"},"sources":null,"sources_link":null}}}]}},"pageContext":{"slug":"/tech/2023-07-28-XSS와-CSRF/","previous":{"fields":{"slug":"/tech/2023-07-21-HTTPS/"},"frontmatter":{"tags":["Https","네트워크"],"update":true,"title":"HTTPS"}},"next":{"fields":{"slug":"/tech/2023-07-31-Token을-어떻게-관리할-것인가/"},"frontmatter":{"tags":["JWT","보안"],"update":true,"title":"Token을 어떻게 관리할 것인가"}}}},"staticQueryHashes":[],"slicesMap":{}}