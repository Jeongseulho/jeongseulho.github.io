{"componentChunkName":"component---src-templates-post-template-tsx","path":"/tech/2023-10-01-React-Suspense/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<h2 id=\"0-들어가며\" style=\"position:relative;\"><a href=\"#0-%EB%93%A4%EC%96%B4%EA%B0%80%EB%A9%B0\" aria-label=\"0 들어가며 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>0. 들어가며</h2>\n<p><code class=\"language-text\">Suspense</code>를 사용한 이유와 사용하면서 겪었던 문제점, 해결 방법을 정리해보았다.</p>\n<h2 id=\"1-suspense란\" style=\"position:relative;\"><a href=\"#1-suspense%EB%9E%80\" aria-label=\"1 suspense란 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. Suspense란?</h2>\n<p><code class=\"language-text\">Suspense</code>로 감싸진 컴포넌트에서 호출하는 Promise가 pending이면 <code class=\"language-text\">fallback</code> props로 전달된 컴포넌트를 렌더링하며 resolve되면 <code class=\"language-text\">children</code> props로 전달된 컴포넌트를 렌더링한다.</p>\n<div\n              class=\"gatsby-code-button-container\"\n              data-toaster-id=\"9983026944073181000\"\n              data-toaster-class=\"gatsby-code-button-toaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text\"\n              data-toaster-text=\"📋  코드를 복사했습니다.\"\n              data-toaster-duration=\"3000\"\n              onClick=\"copyToClipboard(`function Profile() {\r\n  const { data } = useQuery(['userInfo'], fetchUserInfo);\r\n\r\n  return (\r\n    <Suspense fallback={<Loading />}>\r\n      <div>\r\n        <h1>{data.name}</h1>\r\n        <p>{data.job}</p>\r\n      </div>\r\n    </Suspense>\r\n  );\r\n}`, `9983026944073181000`)\"\n            >\n              <div\n                class=\"gatsby-code-button\"\n                data-tooltip=\"\"\n              >\n                copy<svg stroke=\"currentColor\" fill=\"none\" stroke-width=\"2\" viewBox=\"0 0 24 24\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"h-4 w-4\" height=\"1em\" width=\"1em\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2\"></path><rect x=\"8\" y=\"2\" width=\"8\" height=\"4\" rx=\"1\" ry=\"1\"></rect></svg>\n              </div>\n            </div>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">Profile</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> data <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">useQuery</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'userInfo'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> fetchUserInfo<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\r\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Suspense</span></span> <span class=\"token attr-name\">fallback</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Loading</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\r\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\r\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>data<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\r\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>data<span class=\"token punctuation\">.</span>job<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\r\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\r\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Suspense</span></span><span class=\"token punctuation\">></span></span>\r\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"2-왜-suspense를-사용하는가\" style=\"position:relative;\"><a href=\"#2-%EC%99%9C-suspense%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%98%EB%8A%94%EA%B0%80\" aria-label=\"2 왜 suspense를 사용하는가 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. 왜 Suspense를 사용하는가?</h2>\n<h3 id=\"1-선언적-코드\" style=\"position:relative;\"><a href=\"#1-%EC%84%A0%EC%96%B8%EC%A0%81-%EC%BD%94%EB%93%9C\" aria-label=\"1 선언적 코드 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>(1) 선언적 코드</h3>\n<p><code class=\"language-text\">Suspense</code>를 사용하지 않은 코드는 다음과 같다.</p>\n<div\n              class=\"gatsby-code-button-container\"\n              data-toaster-id=\"64067898646693580000\"\n              data-toaster-class=\"gatsby-code-button-toaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text\"\n              data-toaster-text=\"📋  코드를 복사했습니다.\"\n              data-toaster-duration=\"3000\"\n              onClick=\"copyToClipboard(`const Component = () => {\r\n\treturn (\r\n\t\t{isLoading && <Loading />}\r\n\t\t{!isError && !isLoading && <AnotherComponent />}\r\n    {isError && <ErrorComponent />}\r\n\t)\r\n}`, `64067898646693580000`)\"\n            >\n              <div\n                class=\"gatsby-code-button\"\n                data-tooltip=\"\"\n              >\n                copy<svg stroke=\"currentColor\" fill=\"none\" stroke-width=\"2\" viewBox=\"0 0 24 24\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"h-4 w-4\" height=\"1em\" width=\"1em\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2\"></path><rect x=\"8\" y=\"2\" width=\"8\" height=\"4\" rx=\"1\" ry=\"1\"></rect></svg>\n              </div>\n            </div>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Component</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n\t<span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\r\n\t\t<span class=\"token punctuation\">{</span>isLoading <span class=\"token operator\">&amp;&amp;</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Loading</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">}</span>\r\n\t\t<span class=\"token punctuation\">{</span><span class=\"token operator\">!</span>isError <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span>isLoading <span class=\"token operator\">&amp;&amp;</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">AnotherComponent</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">}</span>\r\n    <span class=\"token punctuation\">{</span>isError <span class=\"token operator\">&amp;&amp;</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ErrorComponent</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">}</span>\r\n\t<span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>다음과 같이 로직을 어떤 상황에 어떻게 처리할지 작성하는 것을 명령형 프로그래밍이라고 한다.\r\n위 예시에서는 1가지 데이터를 처리하는데 3가지 경우의 수가 있다, 하지만 두개의 데이터를 처리한다고 가정하면 이것의 제곱인 9개의 경우의 수가 생긴다. 이렇게 중첩되는 데이터의 모든 경우의 수의 조건문을 걸어 처리하는 것은 매우 복잡하다.</p>\n<p>다음은 <code class=\"language-text\">Suspense</code>와 <code class=\"language-text\">ErrorBoundary</code>를 사용한 코드이다.</p>\n<div\n              class=\"gatsby-code-button-container\"\n              data-toaster-id=\"48208102904759984000\"\n              data-toaster-class=\"gatsby-code-button-toaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text\"\n              data-toaster-text=\"📋  코드를 복사했습니다.\"\n              data-toaster-duration=\"3000\"\n              onClick=\"copyToClipboard(`const Component = () => {\r\n  return (\r\n    <Suspense fallback={<Loading />}>\r\n      <ErrorBoundary fallback={<ErrorComponent />}>\r\n        <AnotherComponent />\r\n      </ErrorBoundary>\r\n    </Suspense>\r\n  )\r\n}`, `48208102904759984000`)\"\n            >\n              <div\n                class=\"gatsby-code-button\"\n                data-tooltip=\"\"\n              >\n                copy<svg stroke=\"currentColor\" fill=\"none\" stroke-width=\"2\" viewBox=\"0 0 24 24\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"h-4 w-4\" height=\"1em\" width=\"1em\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2\"></path><rect x=\"8\" y=\"2\" width=\"8\" height=\"4\" rx=\"1\" ry=\"1\"></rect></svg>\n              </div>\n            </div>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Component</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\r\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Suspense</span></span> <span class=\"token attr-name\">fallback</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Loading</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\r\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ErrorBoundary</span></span> <span class=\"token attr-name\">fallback</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ErrorComponent</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\r\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">AnotherComponent</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\r\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">ErrorBoundary</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\r\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Suspense</span></span><span class=\"token punctuation\">></span></span>\r\n  <span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>선언적 프로그래밍으로 작성하면 로직을 작성하는 것이 아니라 어떤 상황에 어떻게 처리할지 작성하는 것이기 때문에 코드가 간결해진다.</p>\n<h3 id=\"2-로딩-구간-분리\" style=\"position:relative;\"><a href=\"#2-%EB%A1%9C%EB%94%A9-%EA%B5%AC%EA%B0%84-%EB%B6%84%EB%A6%AC\" aria-label=\"2 로딩 구간 분리 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>(2) 로딩 구간 분리</h3>\n<p>API 호출로 데이터를 보여줄 때, 한 페이지 내에서 관련된 데이터끼리 그룹화 시켜서 보여주고 싶을 때가 있다.<br>\n또한, 우선적으로 보여줄 데이터와 그 이후 보여줄 데이터를 구분하고 싶을 수도 있다.<br>\n이 때, <code class=\"language-text\">Suspense</code>를 사용하면 로딩 구간을 분리할 수 있다.</p>\n<p>다음은 프로필 페이지의 예시이다, 관심사에 따라 화면에 한꺼번에 보여주고 싶으며 각 컴포넌트에서 API를 호출하고 있다고 해보자.</p>\n<div\n              class=\"gatsby-code-button-container\"\n              data-toaster-id=\"75260604906456500000\"\n              data-toaster-class=\"gatsby-code-button-toaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text\"\n              data-toaster-text=\"📋  코드를 복사했습니다.\"\n              data-toaster-duration=\"3000\"\n              onClick=\"copyToClipboard(`<Suspense fallback={<p>Loading userInfo</p>}>\r\n  <UserInfo />\r\n  <UserPhoto />\r\n</Suspense>\r\n<Suspense fallback={<p>Loading friends</p>}>\r\n  <Follower />\r\n  <Following />\r\n</Suspense>`, `75260604906456500000`)\"\n            >\n              <div\n                class=\"gatsby-code-button\"\n                data-tooltip=\"\"\n              >\n                copy<svg stroke=\"currentColor\" fill=\"none\" stroke-width=\"2\" viewBox=\"0 0 24 24\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"h-4 w-4\" height=\"1em\" width=\"1em\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2\"></path><rect x=\"8\" y=\"2\" width=\"8\" height=\"4\" rx=\"1\" ry=\"1\"></rect></svg>\n              </div>\n            </div>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Suspense</span></span> <span class=\"token attr-name\">fallback</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Loading userInfo</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\r\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">UserInfo</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\r\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">UserPhoto</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\r\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Suspense</span></span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Suspense</span></span> <span class=\"token attr-name\">fallback</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Loading friends</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\r\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Follower</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\r\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Following</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\r\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Suspense</span></span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p><code class=\"language-text\">UserInfo</code>와 <code class=\"language-text\">UserPhoto</code>는 유저의 정보를 보여주는 컴포넌트이고, <code class=\"language-text\">Follower</code>와 <code class=\"language-text\">Following</code>은 유저의 팔로워와 팔로잉을 보여주는 컴포넌트이다.<br>\n이렇게 하면 API 호출을 묶어서 관리할 수 있고, 로딩 구간을 분리할 수 있다.</p>\n<h2 id=\"3-suspense의-waterfall-문제\" style=\"position:relative;\"><a href=\"#3-suspense%EC%9D%98-waterfall-%EB%AC%B8%EC%A0%9C\" aria-label=\"3 suspense의 waterfall 문제 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. Suspense의 waterfall 문제</h2>\n<p><code class=\"language-text\">Suspense</code>를 사용하면서 한 컴포넌트 내에서 여러개의 API를 호출하는 경우가 있었다.<br>\n이 경우, API 호출이 병렬로 일어나지 않고, 하나가 끝나야 다음 요청이 시작되는 것을 Waterfall 문제라고 한다.</p>\n<h3 id=\"1-suspense의-동작-원리\" style=\"position:relative;\"><a href=\"#1-suspense%EC%9D%98-%EB%8F%99%EC%9E%91-%EC%9B%90%EB%A6%AC\" aria-label=\"1 suspense의 동작 원리 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>(1) Suspense의 동작 원리</h3>\n<p>위에서 설명한대로 <code class=\"language-text\">Suspense</code>는 <code class=\"language-text\">Promise</code> 상태에 따라서 <code class=\"language-text\">children</code> 또는 <code class=\"language-text\">fallback</code> 컴포넌트를 반환. 즉, <code class=\"language-text\">pending</code> 상태일 때에는 <code class=\"language-text\">&lt;Loading /></code>을 반환하고 있고, <code class=\"language-text\">children</code>을 실행시키지 않는다.<br>\n그렇기 때문에, 하나의 API 요청이 발생하면, <code class=\"language-text\">children</code> 컴포넌트의 실행은 멈추고 <code class=\"language-text\">&lt;Loading /></code>을 반환, <code class=\"language-text\">Promise</code>가 <code class=\"language-text\">settled</code> 상태가 되면 다시 <code class=\"language-text\">children</code> 컴포넌트를 렌더링 한다.</p>\n<h2 id=\"4-컴포넌트-분리하여-해결\" style=\"position:relative;\"><a href=\"#4-%EC%BB%B4%ED%8F%AC%EB%84%8C%ED%8A%B8-%EB%B6%84%EB%A6%AC%ED%95%98%EC%97%AC-%ED%95%B4%EA%B2%B0\" aria-label=\"4 컴포넌트 분리하여 해결 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. 컴포넌트 분리하여 해결</h2>\n<p>해결은 간단하다 하나의 컴포넌트에서 여러개의 API를 호출하는 것이 아니라, 각각의 API를 호출하는 컴포넌트를 분리하여 해결할 수 있다.</p>\n<div\n              class=\"gatsby-code-button-container\"\n              data-toaster-id=\"8085998121534898000\"\n              data-toaster-class=\"gatsby-code-button-toaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text\"\n              data-toaster-text=\"📋  코드를 복사했습니다.\"\n              data-toaster-duration=\"3000\"\n              onClick=\"copyToClipboard(`<Suspense fallback={<p>Loading userInfo</p>}>\r\n  <UserInfo />\r\n</Suspense>\r\n<Suspense fallback={<p>Loading friends</p>}>\r\n  <Friends />\r\n</Suspense>`, `8085998121534898000`)\"\n            >\n              <div\n                class=\"gatsby-code-button\"\n                data-tooltip=\"\"\n              >\n                copy<svg stroke=\"currentColor\" fill=\"none\" stroke-width=\"2\" viewBox=\"0 0 24 24\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"h-4 w-4\" height=\"1em\" width=\"1em\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2\"></path><rect x=\"8\" y=\"2\" width=\"8\" height=\"4\" rx=\"1\" ry=\"1\"></rect></svg>\n              </div>\n            </div>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Suspense</span></span> <span class=\"token attr-name\">fallback</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Loading userInfo</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\r\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">UserInfo</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\r\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Suspense</span></span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Suspense</span></span> <span class=\"token attr-name\">fallback</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Loading friends</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\r\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Friends</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\r\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Suspense</span></span><span class=\"token punctuation\">></span></span></code></pre></div>\n<h2 id=\"5-마치며\" style=\"position:relative;\"><a href=\"#5-%EB%A7%88%EC%B9%98%EB%A9%B0\" aria-label=\"5 마치며 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5. 마치며</h2>\n<p><code class=\"language-text\">Suspense</code>는 선언적 프로그래밍을 할 수 있게 해준다는 점에서 함수형 컴포넌트 및 <code class=\"language-text\">React Hooks</code>와 잘 어울린다고 생각한다, <code class=\"language-text\">isLoading</code>을 사용하여 로딩 상태를 관리하는 것보다 <code class=\"language-text\">Suspense</code>를 사용하여 로딩 상태를 관리하는 것이 훨씬 간결하고 가독성이 좋다.</p>","tableOfContents":"<ul>\n<li>\n<p><a href=\"#0-%EB%93%A4%EC%96%B4%EA%B0%80%EB%A9%B0\">0. 들어가며</a></p>\n</li>\n<li>\n<p><a href=\"#1-suspense%EB%9E%80\">1. Suspense란?</a></p>\n</li>\n<li>\n<p><a href=\"#2-%EC%99%9C-suspense%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%98%EB%8A%94%EA%B0%80\">2. 왜 Suspense를 사용하는가?</a></p>\n<ul>\n<li><a href=\"#1-%EC%84%A0%EC%96%B8%EC%A0%81-%EC%BD%94%EB%93%9C\">(1) 선언적 코드</a></li>\n<li><a href=\"#2-%EB%A1%9C%EB%94%A9-%EA%B5%AC%EA%B0%84-%EB%B6%84%EB%A6%AC\">(2) 로딩 구간 분리</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#3-suspense%EC%9D%98-waterfall-%EB%AC%B8%EC%A0%9C\">3. Suspense의 waterfall 문제</a></p>\n<ul>\n<li><a href=\"#1-suspense%EC%9D%98-%EB%8F%99%EC%9E%91-%EC%9B%90%EB%A6%AC\">(1) Suspense의 동작 원리</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#4-%EC%BB%B4%ED%8F%AC%EB%84%8C%ED%8A%B8-%EB%B6%84%EB%A6%AC%ED%95%98%EC%97%AC-%ED%95%B4%EA%B2%B0\">4. 컴포넌트 분리하여 해결</a></p>\n</li>\n<li>\n<p><a href=\"#5-%EB%A7%88%EC%B9%98%EB%A9%B0\">5. 마치며</a></p>\n</li>\n</ul>","frontmatter":{"title":"React Suspense","summary":"Suspense를 사용한 이유와 사용하면서 겪었던 문제점, 해결 방법을 정리해보았다.","date":"2023년 10월 01일","tags":["React","React Suspense"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAABWElEQVR42o2RwUsCQRTG/QPaEZx582Z2c80NZN1EkkorrU4KSi650aJrBh4Uq0MUKMVaBNYlg6CDf29kHTLN/C4P5r3f43vfBPhsAUr5WRgTqsY5zBwKzHhDBGBmoWyVjq1ixSo5Uo8AwAIwIoRCatRInXW2Wte7N4/r1eZqJkeVJUQxH0ZgTI0aZv5w5+p+3389eHjLdgdr5ZOwaQENccT5MFWjhlWspDvdbO957+4lc3mbOKqG4wkI/QN/25Z6ZKN5kT7v5bpPqdOWsblNiYKT5N+BMWbmy/GCHc+XrWJF6ivA2EJpU0o5B6lqAgVnTC6HkYMQYiE4FosxxgghQUIUQhRFCQaDhJDp35qAAUDTtHa7XfM827Zd163XPc+rOY7juq6u62zSfODXPkRsNBqj0ajf77+PNRgMfN8fDoeGYVBKf8YWmDajaZoQQkqZTCa/ujjW9M0f5lljrlqL0v0AAAAASUVORK5CYII="},"images":{"fallback":{"src":"/static/864ab535faef6706c40723cd25aed2c6/de59e/image.png","srcSet":"/static/864ab535faef6706c40723cd25aed2c6/a20a2/image.png 279w,\n/static/864ab535faef6706c40723cd25aed2c6/e3b32/image.png 558w,\n/static/864ab535faef6706c40723cd25aed2c6/de59e/image.png 1116w","sizes":"(min-width: 1116px) 1116px, 100vw"},"sources":[{"srcSet":"/static/864ab535faef6706c40723cd25aed2c6/9a396/image.webp 279w,\n/static/864ab535faef6706c40723cd25aed2c6/bca2d/image.webp 558w,\n/static/864ab535faef6706c40723cd25aed2c6/89120/image.webp 1116w","type":"image/webp","sizes":"(min-width: 1116px) 1116px, 100vw"}]},"width":1116,"height":686}},"publicURL":"/static/864ab535faef6706c40723cd25aed2c6/image.png"},"sources":["happysisyphe","daleseo","byseop"],"sources_link":["https://happysisyphe.tistory.com/m/54","https://www.daleseo.com/react-suspense/#suspense-%EC%82%AC%EC%9A%A9-%ED%9B%84","https://byseop.com/post/@b6b6d8b1-e3ed-4b5c-84ee-43defc1875b3"]}}}]}},"pageContext":{"slug":"/tech/2023-10-01-React-Suspense/","previous":{"fields":{"slug":"/tech/2023-09-29-React-Query-도입-이유/"},"frontmatter":{"tags":["React","React State"],"categories":null,"update":true,"title":"React Query 도입 이유"}},"next":{"fields":{"slug":"/tech/2023-10-08-Atomic-패턴-적용에-실패한-이유/"},"frontmatter":{"tags":["React","디자인 패턴"],"categories":null,"update":true,"title":"Atomic 패턴 적용"}}}},"staticQueryHashes":[],"slicesMap":{}}